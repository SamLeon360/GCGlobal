import 'package:flutter/cupertino.dart';import 'package:flutter/material.dart';import 'package:flutter_screenutil/flutter_screenutil.dart';import 'package:gcglobal/HomePage/Wights/GCRowWidget.dart';class GCHomeLeftWidget extends StatefulWidget{  String avatarUrl;  String userName;  String userID;  GCHomeLeftWidget({required this.avatarUrl,required this.userName,required this.userID}):super();  @override  State<StatefulWidget> createState() {    // TODO: implement createState    return GCHomeLeftState();  }}class GCHomeLeftState extends State<GCHomeLeftWidget> with SingleTickerProviderStateMixin{  AnimationController? _animationController;  double dragUpDownX = 0.0;  final double maxDragX = 0.8.sw;  double dragOffset = 0.0;  double dragDownX = 0.0;  bool isOpenState = false;  @override  void initState() {    // TODO: implement initState    super.initState();    _animationController = new AnimationController(vsync: this,duration: const Duration(milliseconds: 1000));   CurvedAnimation curve =  new CurvedAnimation(parent: _animationController!, curve: Curves.bounceOut);    // 增加动画监听，当手势结束的时候通过动态计算到达目标位置的距离实现动画效果。curve.value为当前动画的值，取值范围0~1。    curve.addListener(() {      double animValue = curve.value;      double offset =  dragDownX;      double toPosition;      //左滑      if(offset > (maxDragX/2.0)){        toPosition = maxDragX;        isOpenState = true;      }else{        toPosition = 0.0;        isOpenState = false;      }      // // 右滑      // if (offset < 0.8.sw) {      //   if (offset > maxDragX / 5) {      //     // 打开      //     toPosition = maxDragX;      //     isOpenState = false;      //   } else {      //     if (!isOpenState) {      //       toPosition = maxDragX;      //       isOpenState = true;      //     } else {      //       toPosition = 0.0;      //       isOpenState = false;      //     }      //   }      // } else {      //   if (offset < (maxDragX / 2.0)) {      //     // 关      //     toPosition = 0.0;      //     isOpenState = false;      //   } else {      //     if (!isOpenState) {      //       toPosition = maxDragX;      //       isOpenState = true;      //     } else {      //       toPosition = 0.0;      //       isOpenState = false;      //     }      //   }      // }      dragOffset = toPosition * animValue ;      setState(() {});    });  }  void _onViewDragDown(DragDownDetails callback) {    dragDownX = callback.globalPosition.dx;  }  void _onViewDrag(DragUpdateDetails callback) {    double tmpOffset =  callback.globalPosition.dx;    if (tmpOffset < 0) {      tmpOffset = 0;    }    // 边缘检测    if (tmpOffset < 0) {      tmpOffset = 0.0;    } else if (tmpOffset >= maxDragX) {      tmpOffset = maxDragX;    }    // 刷新    if (dragOffset != tmpOffset) {      dragOffset = tmpOffset;      setState(() {});    }  }  void _onViewDragUp(DragEndDetails callback) {    dragUpDownX = dragOffset;    // 执行动画，每次都从第0帧开始执行    _animationController!.forward(from: 0.0);  }  ///回收  @override  void dispose() {    // TODO: implement dispose    super.dispose();    _animationController!.dispose();  }  @override  Widget build(BuildContext context) {    // TODO: implement build    return Container(      width: MediaQuery.of(context).size.width,      height: MediaQuery.of(context).size.height,      decoration: BoxDecoration(          color: Color(0x80000000)      ),      child: Container(        color: Colors.white,        child: Column(          children: [            ///个人信息            Container(              height: 77,              child: Row(                children: [                  ///头像                  Container(                    width: 65,                    child: Container(                      margin: EdgeInsets.only(left: 15,top: 12),                      decoration: BoxDecoration(                          shape: BoxShape.circle,                          image: DecorationImage(                              image: AssetImage(widget.avatarUrl)                          )                      ),                    ),                  ),                  Column(                    children: [                      ///用户名                      Container(                        alignment: Alignment.centerLeft,                        margin: EdgeInsets.only(left: 12,top: 20),                        child: Text(                          widget.userName,                          style: TextStyle(                              color: Color(0xFF333333),                              fontSize: 16,                              fontWeight: FontWeight.w500                          ),                        ),                      ),                      ///userID                      Container(                        alignment: Alignment.topLeft,                        margin: EdgeInsets.only(left: 12,top: 6),                        child: Text(                          widget.userName,                          style: TextStyle(                              color: Color(0xFF333333),                              fontSize: 16,                              fontWeight: FontWeight.w400                          ),                        ),                      ),                    ],                  )                ],              ),            ),            GCRowWidget(iconUrl:"assets/homepage/edit_info/icon_xiugaigerenziliao@2x.png",title:"修改個人資料",rightIcon: "assets/homepage/right_anchor/icon_youjiantou_X@2x.png",onTap: (){              ///點擊事件            },),            GCRowWidget(iconUrl:"assets/homepage/reset_pwd/icon_chongshedenglumima@2x.png",title:"重設登錄密碼",rightIcon: "assets/homepage/right_anchor/icon_youjiantou_X@2x.png",onTap: (){              ///點擊事件            },),            GCRowWidget(iconUrl:"assets/homepage/report_error/icon_baogaocuowu@2x.png",title:"報告錯誤",rightIcon: "assets/homepage/right_anchor/icon_youjiantou_X@2x.png",onTap: (){              ///點擊事件            },),            GCRowWidget(iconUrl:"assets/homepage/setting/icon_shezhi@2x.png",title:"設置",rightIcon: "assets/homepage/right_anchor/icon_youjiantou_X@2x.png",onTap: (){              ///點擊事件            },),          ],        ),      ),    );  }}